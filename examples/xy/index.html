<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Datastar PixiJS Client-Side Circle</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.1.2/pixi.min.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/gh/starfederation/datastar@v1.0.0-beta.11/bundles/datastar.js"></script>
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; gap: 10px; margin-top: 20px; }
        .controls { display: flex; flex-direction: column; gap: 5px; margin-bottom: 10px; }
        label { display: flex; align-items: center; gap: 5px; }
        input[type="range"] { width: 200px; }
        #pixi-canvas-container canvas { border: 1px solid black; }
    </style>
</head>
<body
    data-signals="{ x: 50, y: 50 }"
    data-on-load="
       init();
	   updatePixiCircleDrawing($x,$y);
    "
    data-on-signal-change="updatePixiCircleDrawing($x,$y)"
>

    <h1>PixiJS Circle Controlled by Datastar Signals</h1>

    <div class="controls">
        <label>
            X: <input type="range" min="0" max="100" data-bind-x />
            <span data-text="$x"></span>
        </label>
        <label>
            Y: <input type="range" min="0" max="100" data-bind-y />
            <span data-text="$y"></span>
        </label>
    </div>

    <div id="pixi-canvas-container">
        <!-- PixiJS canvas will be appended here -->
    </div>

    <script>
		// window.init = function(){

		init = function(){
			 // Make Pixi app and graphic globally accessible for our helper function
        window.myPixiApp = new PIXI.Application({ width: 100, height: 100, backgroundColor: 0xeeeeee });
        document.getElementById('pixi-canvas-container').appendChild(window.myPixiApp.view);

        window.myCircleGraphic = new PIXI.Graphics();
        window.myPixiApp.stage.addChild(window.myCircleGraphic);

        // Initial draw using the helper function
        window.updatePixiCircleDrawing();
		}
        // This function will be called by Datastar to update the PixiJS rendering.
        // It accesses Datastar signals as args	
        window.updatePixiCircleDrawing = function(x,y) {
           
            window.myCircleGraphic.clear(); // Clear previous drawing
            window.myCircleGraphic.beginFill(0xFF0000); // Red color
            window.myCircleGraphic.drawCircle(x, y, 10); // x, y, radius
            window.myCircleGraphic.endFill();
            
            // PIXI.Application's ticker usually handles rendering automatically
            // when a DisplayObject's properties change.
            // If using a raw PIXI.Renderer, you might need:
            // window.myPixiApp.renderer.render(window.myPixiApp.stage);
        }
    </script>

</body>
</html>